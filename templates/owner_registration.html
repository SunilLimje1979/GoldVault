<!doctype html>
{% load static %}
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, viewport-fit=cover" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#000000">
    <title>Owner Registration</title>
    <meta name="description" content="Gold Vault">
    <meta name="keywords" content="Gold, Investment, Saving, Small Investment" />
    <link rel="icon" type="image/png" href="{% static 'assets/img/favicon.png' %}" sizes="32x32">
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'assets/img/icon/192x192.png' %}">
    <link rel="stylesheet" href="{% static 'assets/css/style.css' %}">
</head>
<style>
.logo {
    max-width: 100%;
    height: auto;
    display: block;          /* ensures margin works */
    margin: 0 auto;          /* centers horizontally */
    padding: 0 50px;         /* left & right spacing */
    border-radius: 200px;     /* rounded corners */
}

body {
    margin: 0;
    min-height: 100vh;
    background: linear-gradient(135deg, #e1eee7, #e6ecdf);
    font-family: Arial, sans-serif;
    color: #000;  /* changed from white (#fff) to black (#000) */
}

.form-control, 
.form-control option, 
label {
    color: #000 !important;
    background-color: #fff !important;
}

</style>
<body>
<div id="appCapsule">
    {% comment %} <div class="section text-center">
        <img src="{% static 'assets/img/gold_v.png' %}" alt="Logo" class="logo" width="180" height="60">
        <h1 style="color:#ffffff;">Gold Vault</h1>
    </div> {% endcomment %}

    <div class="section text-center">
        <img src="{% static 'assets/img/gold_v.png' %}" alt="Logo" class="logo">
        {% comment %} <h1 style="color:#ffffff;">Gold Vault</h1> {% endcomment %}
    </div>

    <div class="section mt-1 text-center">
        <h2 style="color:#ffffff; margin-top:0px; font-size:20px; text-transform: uppercase;">
            Jeweller Registration
        </h2>
    </div>

    <div class="section mb-2 p-2">
        <form method="post" action="{% url 'owner_registration' %}" enctype="multipart/form-data">
        {% comment %} <form method="post" action="{% url 'owner_registration' %}"> {% endcomment %}
            {% csrf_token %}
            <div class="card">
                <div class="card-body">

                    <!-- Business Name -->
                    <div class="form-group basic animated">
                        <div class="input-wrapper">
                            <label class="label" for="BusinessName">Business Name</label>
                            <input type="text" class="form-control" id="BusinessName" name="BusinessName" placeholder="Business Name">
                        </div>
                    </div>

                    <!-- Business Address -->
                    <div class="form-group basic animated">
                        <div class="input-wrapper">
                            <label class="label" for="BusinessAddress">Business Address</label>
                            <input type="text" class="form-control" id="BusinessAddress" name="BusinessAddress" placeholder="Business Address">
                        </div>
                    </div>

                    {% comment %} 
                    <!-- State ID -->
                    <div class="form-group basic animated">
                        <div class="input-wrapper">
                            <label class="label" for="BusinessStateId">Business State ID</label>
                            <input type="number" class="form-control" id="BusinessStateId" name="BusinessStateId" placeholder="State ID">
                        </div>
                    </div> {% endcomment %}

                    <!-- Business State -->
                   <div class="form-group basic animated" style="color: black !important; background-color: white;">
                        <div class="input-wrapper">
                            <label class="label" for="BusinessStateId">Business State</label>
                            <select class="form-control" id="BusinessStateId" name="BusinessStateId" 
                                    style="color: black !important; background-color: white;" required>
                                <option value="" style="color: black;">-- Select State --</option>
                                {% for state in states %}
                                    <option value="{{ state.StateId }}" style="color: black;">{{ state.Name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <!-- City ID -->
                    {% comment %} <div class="form-group basic animated">
                        <div class="input-wrapper">
                            <label class="label" for="BusinessCityId">Business City ID</label>
                            <input type="number" class="form-control" id="BusinessCityId" name="BusinessCityId" placeholder="City ID">
                        </div>
                    </div> {% endcomment %}

                    <!-- Business City -->
                    <div class="form-group basic animated">
                        <div class="input-wrapper">
                            <label class="label" for="BusinessCityId">Business City</label>
                            <select class="form-control" id="BusinessCityId" name="BusinessCityId" required>
                                <option value="">-- Select City --</option>
                            </select>
                        </div>
                    </div>

                    <!-- Owner Name -->
                    <div class="form-group basic animated">
                        <div class="input-wrapper">
                            <label class="label" for="OwnerName">Owner Name</label>
                            <input type="text" class="form-control" id="OwnerName" name="OwnerName" placeholder="Owner Name">
                        </div>
                    </div>

                    <!-- Owner Contact -->
                    <div class="form-group basic animated">
                        <div class="input-wrapper">
                            <label class="label" for="OwnerContact">Owner Contact</label>
                            <input type="text" class="form-control" id="OwnerContact" name="OwnerContact" placeholder="Mobile Number">
                        </div>
                    </div>

                    <!-- Login Pin -->
                    <div class="form-group basic animated">
                        <div class="input-wrapper">
                            <label class="label" for="LoginPin">Login Pin</label>
                            <input type="password" class="form-control" id="LoginPin" name="LoginPin" maxlength="4" placeholder="4 Digit Pin">
                        </div>
                    </div>

                    <!-- Email -->
                    <div class="form-group basic animated">
                        <div class="input-wrapper">
                            <label class="label" for="OwnerEmail">Owner Email</label>
                            <input type="email" class="form-control" id="OwnerEmail" name="OwnerEmail" placeholder="Email">
                        </div>
                    </div>

                    <!-- Shop Photo URL -->
                    <div class="form-group basic animated">
                        <div class="input-wrapper">
                            <label class="label" for="ShopPhotoURL">Shop Photo</label>
                            <input type="file" class="form-control" id="ShopPhotoURL" name="ShopPhotoURL" accept="image/*">
                        </div>
                    </div>

                    <!-- UPI ID -->
                    <div class="form-group basic animated">
                        <div class="input-wrapper">
                            <label class="label" for="UPIID">UPI ID</label>
                            <input type="text" class="form-control" id="UPIID" name="UPIID" placeholder="UPI ID">
                        </div>
                    </div>

                    <!-- Bank Account Name -->
                    <div class="form-group basic animated">
                        <div class="input-wrapper">
                            <label class="label" for="BankAccountName">Bank Account Name</label>
                            <input type="text" class="form-control" id="BankAccountName" name="BankAccountName" placeholder="Account Holder">
                        </div>
                    </div>

                    <!-- Bank Account No -->
                    <div class="form-group basic animated">
                        <div class="input-wrapper">
                            <label class="label" for="BankAccountNo">Bank Account Number</label>
                            <input type="text" class="form-control" id="BankAccountNo" name="BankAccountNo" placeholder="Account Number">
                        </div>
                    </div>

                    <!-- Bank Name -->
                    <div class="form-group basic animated">
                        <div class="input-wrapper">
                            <label class="label" for="BankName">Bank Name</label>
                            <input type="text" class="form-control" id="BankName" name="BankName" placeholder="Bank Name">
                        </div>
                    </div>

                    <!-- Branch Name -->
                    <div class="form-group basic animated">
                        <div class="input-wrapper">
                            <label class="label" for="BranchName">Branch Name</label>
                            <input type="text" class="form-control" id="BranchName" name="BranchName" placeholder="Branch Name">
                        </div>
                    </div>

                    <!-- IFSC Code -->
                    <div class="form-group basic animated">
                        <div class="input-wrapper">
                            <label class="label" for="IFSCCode">IFSC Code</label>
                            <input type="text" class="form-control" id="IFSCCode" name="IFSCCode" placeholder="IFSC Code">
                        </div>
                    </div>

                    <!-- Branch Address -->
                    <div class="form-group basic animated">
                        <div class="input-wrapper">
                            <label class="label" for="BranchAddress">Branch Address</label>
                            <input type="text" class="form-control" id="BranchAddress" name="BranchAddress" placeholder="Branch Address">
                        </div>
                    </div>

                    <!-- Submit -->
                    <div class="transparent mt-2">
                        <button type="submit" class="btn btn-block btn-lg w-100"
                        style="background-color:#edc88f !important;border-color:#edc88f !important;color:black !important;border-radius:8px;font-weight:600;"> Submit
                       </button>
                        
                    </div>

                </div>
            </div>
        </form>
    </div>
</div>
<!-- in <head> -->
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />

<!-- before </body> -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.js"></script>

    {% if messages %}
        <script>
            {% for message in messages %}
                var msg = "{{ message|escapejs }}";
                var tag = "{{ message.tags }}";

                {% comment %} console.log(msg);
                console.log(tag); {% endcomment %}
                var alertType = "info";
                var alertTitle = "Info"; 

                if (tag.includes("success")) {
                    alertType = "success";
                    alertTitle = "Success!";
                } else if (tag.includes("danger")) {
                    alertType = "error";
                    alertTitle = "Error!";
                }

                swal({
                    title: alertTitle,
                    text: msg,
                    type: alertType,
                    //timer: 5000,
                    showConfirmButton: true
                });
            {% endfor %}
        </script>
    {% endif %}



<script>
    $(document).ready(function () {
    // Initialize State dropdown with Select2
    $('#BusinessStateId').select2({
        placeholder: "-- Select State --",
        allowClear: true,
        width: '100%'
    });

    // Initialize City dropdown with Select2
    $('#BusinessCityId').select2({
        placeholder: "-- Select City --",
        allowClear: true,
        width: '100%'
    });

    // On state change -> fetch cities
    $('#BusinessStateId').on('change', function () {
        var stateId = $(this).val();
        var countryId = 101;  // fixed country id

        if (stateId) {
            $.ajax({
                url: "{% url 'get_cities' %}",   // Django URL
                type: "POST",
                headers: {
                    "Accept": "application/json",
                    "Content-Type": "application/json",
                    "X-CSRFToken": "{{ csrf_token }}"
                },
                data: JSON.stringify({
                    "CountryId": countryId,
                    "StateId": stateId
                }),
                success: function (response) {
                    var citySelect = $("#BusinessCityId");
                    citySelect.empty(); // clear old options
                    citySelect.append('<option value="">-- Select City --</option>');

                    if (response.message_data && response.message_data.length > 0) {
                        $.each(response.message_data, function (index, city) {
                            citySelect.append(
                                $("<option>", {
                                    value: city.CityId,
                                    text: city.Name
                                })
                            );
                        });
                    }

                    // Refresh Select2 after adding new options
                    citySelect.trigger('change');
                },
                error: function (xhr, status, error) {
                    console.error("Error fetching cities:", error);
                }
            });
        } else {
            // If no state selected, clear cities
            $('#BusinessCityId').empty().append('<option value="">-- Select City --</option>').trigger('change');
        }
    });
});

</script>

</body>
</html>
